
function config (file) {
  var path = module.paths[1]
  path = path.substr(0, module.paths[1].match('node_modules').index)
  global.config = global.config || {}
  global.config = extend(global.config, require(path + file))
}

function extend (dest, source) {
  Object.keys(source).forEach(function (key) {
    if (typeOf(source[key]) == 'object') {
      dest[key] = dest[key] || {}
      dest[key] = extend(dest[key], source[key])
    }
    else if (typeOf(source[key]) == 'array')
      dest[key] = dest[key].concat(source[key])
    else
      dest[key] = source[key]
  })
  return dest
}

function typeOf (thing) { 
  if (typeof thing == 'object') 
    if (typeof thing.length != 'undefined') 
      return 'array'
    else 
      return 'object'
  else
    return typeof thing
}

console.log(process.env['NODE_ENV'])
config('config')
config(process.env['NODE_ENV'])

module.exports = config
